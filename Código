#include <PubSubClient.h>

#include <UIPEthernet.h> #include <utility/logging.h>

#include <SPI.h>

if estado_sensor

boolean mensagem;

//Define o endereço MAC que será utilizado byte mac[] = {0xCC, 0x4D, 0x47, 0xFD, 0x02, 0xAB};

//Inicia o cliente Ethernet EthernetClient client;

PubSubClient mqttClient(client);

void setup() { //Inicia o controlador Ethernet e solicita um IP para o servidor de DHCP Ethernet.begin(mac);

//Inicia o monitor Serial
Serial.begin(9600);

mqttClient.setServer("3.87.59.89",1883);

//Exibe no Monitor Serial as informações sobre o IP do Arduino
Serial.print("O IP do Arduino e: ");
Serial.println(Ethernet.localIP());

//Exibe no Monitor Serial as informações sobre a Máscara de Rede do Arduino
Serial.print("A Mascara de Rede do Arduino e: ");
Serial.println(Ethernet.subnetMask());

//Exibe no Monitor Serial as informações sobre o Gateway do Arduino
Serial.print("O Gateway do Arduino e: ");
Serial.println(Ethernet.gatewayIP());

//Exibe uma linha em branco
Serial.println("");
}

void loop() { mqttClient.connect("damiao"); mensagem = mqttClient.publish("damiao-t","Olá Marte!"); mqttClient.loop(); Serial.println(mensagem); delay(500);

estado_sensor = digitalRead(pino2);
if(estado_sensor == 0) {
Serial.println ("RACK FECHADO!");
delay(1000);
}

else{
Serial.println ("RACK ABERTO!");
delay(1000);
}

} }